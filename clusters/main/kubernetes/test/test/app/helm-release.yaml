apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
    name: hasty-paste
    namespace: test
spec:
    interval: 5m
    chart:
        spec:
            # renovate: registryUrl=https://charts.truechartsoci.org
            chart: hasty-paste
            version: 8.11.6
            sourceRef:
                kind: HelmRepository
                name: truecharts
                namespace: flux-system
            interval: 5m
    install:
        createNamespace: true
        crds: CreateReplace
        remediation:
            retries: 3
    upgrade:
        crds: CreateReplace
        remediation:
            retries: 3
    values:
      global:
        stopAll: false
      hastyPaste:
        branding:
          css_file: ""
          description: ""
          favicon: ""
          hide_version: false
          icon: ""
          title: ""
        enable_public_list: false
        interface:
          default_expire_time_days: 0
          default_expire_time_enable: false
          default_expire_time_hours: 1
          default_expire_time_minutes: 0
          default_use_long_id: false
        log_level: INFO
        max_body_size: 2000000
        new_at_index: false
        workers: 1
      image:
        pullPolicy: IfNotPresent
        repository: ghcr.io/enchant97/hasty-paste
        tag: 2.0.0@sha256:9afbe8703bb91ceb3b1e8de526155a980359981e838a42ded97548ef89b26869
      persistence:
        config:
          enabled: true
          mountPath: /opt/hasty-paste/data
      portal:
        open:
          enabled: true
      redis:
        enabled: false
        username: default
      service:
        main:
          loadBalancerIP: 192.168.178.253
          type: LoadBalancer
          ports:
            main:
              port: 10601
              protocol: http
      workload:
        main:
          podSpec:
            containers:
              main:
                envFrom:
                env:
                  PUBLIC_URL: "http://example.com"
                  # Secrets can be generated by this command: openssl rand -base64 32
                  AUTH_TOKEN_SECRET: CmKH8PetPXfkBKWqejMyeLafMkHSY1agTk0z3yd1bY8=
                  SESSION_SECRET: CmKH8PetPXfkBKWqejMyeLafMkHSY1agTk0z3yd1bY8=
                  BIND__PORT: "{{ .Values.service.main.ports.main.port }}"
                  BEHIND_PROXY: true
                probes:
                  liveness:
                    custom: false
                    enabled: true
                  readiness:
                    custom: false
                    enabled: true
                  startup:
                    custom: false
                    enabled: true